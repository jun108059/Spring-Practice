# ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜í•˜ê¸°

ìˆœìˆ˜í•œ ìë°” ì½”ë“œë§Œìœ¼ë¡œ DIë¥¼ ì ìš©í–ˆë‹¤.

ì´ì œ ìŠ¤í”„ë§ì„ í™œìš©í•´ë³´ì!

## AppConfig ìŠ¤í”„ë§ ê¸°ë°˜ìœ¼ë¡œ ë³€ê²½

- AppConfig

  ```java
  @Configuration
  public class AppConfig {

      @Bean
      public MemberService memberService() {
          return new MemberServiceImpl(getMemberRepository());
      }

      @Bean
      public MemberRepository getMemberRepository() {
          return new MemoryMemberRepository();
      }

      @Bean
      public OrderService orderService() {
          return new OrderServiceImpl(getMemberRepository(), getDiscountPolicy());
      }

      @Bean
      public DiscountPolicy getDiscountPolicy() {
  //        return new FixDiscountPolicy();
          return new RateDiscountPolicy();
      }
  }

  ```
- @Configuration : ì„¤ì •ì„ êµ¬ì„±í•œë‹¤ëŠ” ëœ»
- @Bean : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë¹ˆìœ¼ë¡œ ë“±ë¡!

## MemberApp & OrderApp ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì ìš©

```java
ApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);
```

â†’ ìŠ¤í”„ë§ì˜ ëª¨ë“  ì‹œì‘ì€ Application Contextì—ì„œ ì‹œì‘!

<aside>

ğŸ’¡ **ApplicationContext â‡’ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ**

</aside>

â†’ ìŠ¤í”„ë§ ë¹ˆ ê´€ë ¨ ì„¤ì • ì •ë³´ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì¤Œ (`AppConfig.class`)

- MemberApp

  ```java
  public class MemberApp {
      public static void main(String[] args) {
  //        AppConfig appConfig = new AppConfig();
  //        MemberService memberService = appConfig.memberService();
          ApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);
          MemberService memberService = ac.getBean("memberService", MemberService.class);

          Member member = new Member(1L, "memberA", Grade.VIP);
          memberService.join(member);

          Member findMember = memberService.findMember(1L);
          System.out.println("new Member : " + findMember.getName());
      }
  }

  ```

ì´ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë‹ˆê¹Œ ë­”ê°€ ë¡œê·¸ê°€ ë‚¨ê²Œ ë¨

- ë¡œê·¸ë³´ê¸°

  ```java
  Task :MemberApp.main()
  15:59:29.885 [main] DEBUG org.springframework.context.annotation.AnnotationConfigApplicationContext - Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@c46bcd4
  15:59:29.942 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'org.springframework.context.annotation.internalConfigurationAnnotationProcessor'
  15:59:30.427 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'org.springframework.context.event.internalEventListenerProcessor'
  15:59:30.434 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'org.springframework.context.event.internalEventListenerFactory'
  15:59:30.445 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'org.springframework.context.annotation.internalAutowiredAnnotationProcessor'
  15:59:30.452 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'org.springframework.context.annotation.internalCommonAnnotationProcessor'
  15:59:30.488 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'appConfig'
  15:59:30.500 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'memberService'
  15:59:30.548 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'getMemberRepository'
  15:59:30.560 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'orderService'
  15:59:30.567 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating shared instance of singleton bean 'getDiscountPolicy'
  new Member : memberA
  ```

<aside>

ğŸ’¡ ì‹±ê¸€í†¤ beanì„ ìƒì„±í•´ì£¼ì–´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤Œ!  
Creating shared instance of singleton bean 'appConfig'  
Creating shared instance of singleton bean 'memberService'  
ë“±ë“±

</aside>

- OrderApp

  ```java
  public class OrderApp {

      public static void main(String[] args) {
  //        AppConfig appConfig = new AppConfig();
  //        MemberService memberService = appConfig.memberService();
  //        OrderService orderService = appConfig.orderService();

          ApplicationContext ac = new AnnotationConfigApplicationContext(AppConfig.class);

          MemberService memberService = ac.getBean("memberService", MemberService.class);
          OrderService orderService = ac.getBean("orderService", OrderService.class);

          Long memberId = 1L;
          Member member = new Member(memberId, "itemA", Grade.VIP);
          memberService.join(member);

          Order order = orderService.createOrder(memberId, "itemA", 10000);

          System.out.println("order : " + order);
      }
  }

  ```

## ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ

- ApplicationContext ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ í•œë‹¤.
- ê¸°ì¡´ì—ëŠ” ê°œë°œìê°€ AppConfig ë¥¼ ì‚¬ìš©í•´ì„œ ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  DIë¥¼ í–ˆì§€ë§Œ, ì´ì œë¶€í„°ëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ì„œ ì‚¬ìš©í•œë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” `@Configuration` ì´ ë¶™ì€ AppConfig ë¥¼ ì„¤ì •(êµ¬ì„±) ì •ë³´ë¡œ ì‚¬ìš©í•œë‹¤.
  ì—¬ê¸°ì„œ `@Bean` ì´ë¼ ì íŒ ë©”ì„œë“œë¥¼ ëª¨ë‘ í˜¸ì¶œí•´ì„œ ë°˜í™˜ëœ ê°ì²´ë¥¼ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡**í•œë‹¤. ì´ë ‡ê²Œ **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆ**ì´ë¼ í•œë‹¤.
- ìŠ¤í”„ë§ ë¹ˆì€ @Bean ì´ ë¶™ì€ **ë©”ì„œë“œì˜ ëª…ì„ ìŠ¤í”„ë§ ë¹ˆì˜ ì´ë¦„**ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.
  â†’ `memberService` ,`orderService`

  â†’ ~~ë°”ê¾¸ë ¤ë©´ @Bean(name = xxxx) ì´ë ‡ê²Œ í•˜ë©´ ë¨~~
- ì´ì „ì—ëŠ” ê°œë°œìê°€ í•„ìš”í•œ ê°ì²´ë¥¼ AppConfig ë¥¼ ì‚¬ìš©í•´ì„œ ì§ì ‘ ì¡°íšŒí–ˆì§€ë§Œ,
  ì´ì œë¶€í„°ëŠ” **ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë¥¼ í†µí•´ì„œ í•„ìš”í•œ ìŠ¤í”„ë§ ë¹ˆ(ê°ì²´)ë¥¼ ì°¾ì•„ì•¼ í•œë‹¤.**
  ìŠ¤í”„ë§ ë¹ˆì€ **applicationContext.getBean()** ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì°¾ì„ ìˆ˜ ìˆë‹¤.
- ê¸°ì¡´ì—ëŠ” ê°œë°œìê°€ ì§ì ‘ ìë°”ì½”ë“œë¡œ ëª¨ë“  ê²ƒì„ í–ˆë‹¤ë©´ ì´ì œë¶€í„°ëŠ”

  1. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ê°ì²´ë¥¼ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê³ ,
  2. ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í”„ë§ ë¹ˆì„ ì°¾ì•„ì„œ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½
